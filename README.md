## 基于微信公众平台的贷款预约系统

### 使用技术

SpringBoot + MyBatis 

### 开发环境

1、MySQL + Maven

2、用natapp做内网穿透、[微信SDK](https://github.com/Wechat-Group/WxJava)

### 运行截图

![image-20200719183619539](images\image-20200719183619539.png)

### 系统角色

![](\images\image-20200719182524987.png)

### 角色用例

![image-20200719183152340](\images\image-20200719183152340.png)

### 实现功能

#### 学生身份认证

学生通过点击菜单栏或者发送消息得到贷款办理预约平台的图文消息。首次点击进入提示用户注册，也就是填写个人身份信息用于身份信息认证，实质上是查询该学生的信息是否在贫困学生名单里面，而这个名单是被系统管理员所管理的。填写个人信息完成后，点击提交个人信息按钮，若该学生在贫困学生名单里面则完成认证，否则提示学生拿上相关材料去学生资助中心验证身份。

#### 预约功能

学生登录后显示所有窗口的当前预约情况和工作时间，用户可以根据自己的时间来选择一个窗口，点击预约按钮。预约完成后，微信会提示预约成功还是失败。在还没有叫到号码的用户也还可以取消预约。学生在微信端点击预约按钮会向后台controller接口层发送请求，业务逻里面会操作数据库，数据库的改变是窗口表中的字段，将窗口的最大可预约人数减少1，窗口的等待人数增加1，再讲窗口id对应学生id存储到预约表中。贷款预约平台获取到当前窗口预约人员信息，对预约学生的预约做应答，通过在线下叫序号来确认学生是否到达，等候时间设为2分钟。若在规定时间内有学生持序号来到窗口办理业务，则工作人员在贷款预约平台上点击完成预约按钮结束此次预约。同时更新微信公众号上预约平台的当前预约信息。工作人员在后台管理系统会处理所在窗口的预约请求，浏览器中会显示当前的预约请求，点击开始处理按钮就会向服务端发送请求，在服务端将修改预约的状态，把“等待”状态更改成为“处理中”状态，当办理完贷款之后把“处理中状态”更改为“已完成”状态，成功之后隐藏预约记录。

####  用户管理

用户管理包含对学生信息的管理和对员工信息的管理。学生信息管理。系统管理员维护着学生的个人信息，如学生的身份证号码、电话号码和居住地址等信息。在浏览器页面上分别有增删改查的按钮，每一个按钮都对应服务端controller接口地址，最终是对数据库的操作，牵扯到页面信息的显示用thymeleaf模板来完成，其内置有很多标签如迭代集合元素等。员工信息的管理。系统管理员也维护员工的信息，包含员工所在的窗口，员工的个人信息等，学生信息管理实现的流程基本一样。

#### 评价功能

贷款办理评价功能有学生在微信公众号上对服务的评价功能和评价在贷款办理预约平台的展示。管理员在后台管理系统中可以查看到学生对服务的评价信息。学生在服务完成之后，可以对服务窗口进行评价，评论模块的实现用的是数据库中的评论表，评论表中有用户id，窗口id和评论的内容，学生对某一个窗口的评论就写到这个表中，对应着就是一个学生评论一个窗口。

#### 预约时间设置

系统管理员可以在PC端使用浏览器维护窗口的信息， 对窗口进行管理，包括窗口号，窗口的最大支持预约个数，窗口的开放时间和窗口的关闭时间等都可以进行管理。学生在身份认证成功之后，选中某一个窗口点击预约按钮之后，先会去数据库内查询该窗口的开放时间，业务逻辑内判断在系统当前时间窗口是否开放预约状态，如果没有开放就提示学生预约失败的原因是不在时间段内。系统管理员对预约时间的的设置就是修改窗口表中的窗口开放时间字段的值。

